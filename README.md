# ExcelBapiTool
Excel BAPI実行ツール

## 概要
SAPのBAPIをExcelマクロで実行するものです。
Excelシート上にBAPIパラメータの定義情報を記述することで、汎用的に使用することが可能です。

## 前提
SAP GUI（RFCコントロール）がインストール済であること。
64Bit版Excelを使用する場合は、GUI770以降で64Bit版RFCコントロールのインストールが必要。

## 使用方法
- 2023/02/03更新：BAPIパラメータをSAPから取得して投入シートの定義情報を生成する機能を追加しました。

### 定義シート
BAPIパラメータを読み込んで投入シートを作成します。
1. BAPI名(セルF1)に定義情報を読み込みたいBAPI名を入力して「BAPI取得」ボタンを押下します。
2. 使用したい入力パラメータ(B列)・出力パラメータ(C列)に「X」を入力して「投入シート作成」ボタンを押下します。

### 投入シート
BAPIパラメータが展開されているので、実行したい内容を下図のように編集します。
- 1～2行目：BAPI定義
  - セルC1：BAPI名
  - セルC2：コミット実行（X＝コミット実行、ブランク＝ロールバック実行）
- 3～7行目：BAPIパラメータ定義
  - 4行目：パラメータ種類（下図の例だとC列～S列が入力パラメータ、T列の「end」が入力パラメータの終了、U～Y列が出力パラメータです。）
  - 5行目：パラメータ項目名
  - 6行目：パラメータ構造項目名（6行目がブランクの場合は単一項目）
  - 7行目：項目テキスト
- 8行目以降：BAPI設定値
  - B列：BAPI処理単位の開始行にXを入れるとその単位で処理実行されます。下図の例だと8～10行目、11～13行目、14～16行目が処理単位となります。最終行に「end」を入力してください。

「BAPI実行」ボタンを押下すると、SAPログオン画面が表示され、ログオン後にBAPI実行されます。

下図の例はS/4HANAのBest Practices環境で受注伝票登録可能なデータです。I列のテスト実行の「X」をクリアして実行してください。
![Excelシート編集例](/ExcelSheet_sample.png)


## 補足
以前に個人的に作って使っていたツールですが、Microsoft Officeの64ビット版を使うようになってRFCコントロールが使えなくなったためお蔵入りしていました。
SAP GUI770で64Bit版のRFCコントロールがリリースされたので公開することとしました。
